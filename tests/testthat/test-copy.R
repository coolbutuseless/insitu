


test_that("br_copy works", {

  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Copy full vectors of the same length
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~  
  N <- 10
  x <- rep(1, N)
  y <- as.numeric(seq(N))
  
  br_copy(x, y)
  expect_equal(x, y)

  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Error if vectros different lengths and 'n' not specified
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  N <- 10
  x <- rep(1, N)
  y <- as.numeric(seq(N - 1))
  
  expect_error(
    br_copy(x, y),
    "copy exceeds size"
  )
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Different sizes allowed if 'n'  specified
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  N <- 10
  x <- rep(1, N)
  y <- as.numeric(seq(N - 5))
  
  br_copy(x, y, n = length(y))
  expect_equal(
    x, 
    c(1, 2, 3, 4, 5,  1, 1, 1, 1, 1)
  )
  
  
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Specify start xi
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  N <- 10
  x <- rep(1, N)
  y <- as.numeric(seq(N - 5))
  
  br_copy(x, y, n = length(y), xi = 6)
  expect_equal(
    x, 
    c(1, 1, 1, 1, 1,  1, 2, 3, 4, 5)
  )
  
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Specify start xi and yi and n
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  N <- 10
  x <- rep(1, N)
  y <- as.numeric(seq(N - 5))
  
  br_copy(x, y, n = length(y) - 1, xi = 6, yi = 2)
  expect_equal(
    x, 
    c(1, 1, 1, 1, 1,  2, 3, 4, 5,   1)
  )
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Scalar y
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  N <- 10
  x <- rep(1, N)
  y <- 2
  
  br_copy(x, y, n = 3)
  expect_equal(
    x, 
    c(2, 2, 2, 1, 1,  1, 1, 1, 1, 1)
  )
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Scalar y with xi
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  N <- 10
  x <- rep(1, N)
  y <- 2
  
  br_copy(x, y, n = 3, xi = 3)
  expect_equal(
    x, 
    c(1, 1, 2, 2, 2,  1, 1, 1, 1, 1)
  )
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Scalar y default
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  N <- 10
  x <- rep(1, N)
  y <- 2
  
  br_copy(x, y)
  expect_equal(
    x, 
    c(2, 2, 2, 2, 2,  2, 2, 2, 2, 2)
  )
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Negative indices
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  x <- as.numeric(seq(N))
  y <- as.numeric(seq(N))
  
  br_copy(x, y, n = 2, xi = -2, yi = -5)
  expect_equal(
    x, 
    c(1, 2, 3, 4, 5,   6, 7, 8, 6, 7)
  )
  
  
})
