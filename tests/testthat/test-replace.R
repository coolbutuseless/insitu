

test_that("br_replace() works", {
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # sequential y
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  x <- c(1, 2, 3, 4, 5)
  y <- c(99, 98)
  xi <- c(1L, 3L)
  
  br_replace(x, xi, y)
  expect_identical(x, c(99, 2, 98, 4, 5))
  
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # explicit y
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  x <- c(1, 2, 3, 4, 5)
  y <- c(99, 98, 97, 96)
  xi <- c(1L, 3L)
  yi <- c(4L, 3L)
  
  br_replace(x, xi, y, yi)
  expect_identical(x, c(96, 2, 97, 4, 5))
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # explicit y. xi and yi can be reals that get converted to integer
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  x <- c(1, 2, 3, 4, 5)
  y <- c(99, 98, 97, 96)
  xi <- c(1, 3)
  yi <- c(4, 3)
  
  br_replace(x, xi, y, yi)
  expect_identical(x, c(96, 2, 97, 4, 5))
  
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Error: Insufficient y
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  x <- c(1, 2, 3, 4, 5)
  y <- c(99)
  xi <- c(1L, 3L)
  
  expect_error(
    br_replace(x, xi, y),
    "mismatch in length"
  )
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Good
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  x <- c(1, 2, 3, 4, 5)
  y <- c(99)
  xi <- c(1L, 3L)
  yi <- c(1L, 1L)
  
  br_replace(x, xi, y, yi)
  expect_identical(x, c(99, 2, 99, 4, 5))
  
  
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  # Error: Insufficient y
  #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  x <- c(1, 2, 3, 4, 5)
  y <- c(99)
  xi <- c(1L, 3L)
  yi <- c(2L)
  
  expect_error(
    br_replace(x, xi, y, yi),
    "mismatch in length"
  )
  
})
